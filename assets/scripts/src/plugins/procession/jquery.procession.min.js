(function(e,t,n,r){"use strict";var i=t.Modernizr;(function(){var e,n=function(){},r=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],i=r.length,s=t.console=t.console||{};while(i--){e=r[i];s[e]||(s[e]=n)}})();var s=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},o="Moz Webkit O Ms".split(" "),u=function(e){var t=n.documentElement.style,r;if(typeof t[e]=="string")return e;e=s(e);for(var i=0,u=o.length;i<u;i++){r=o[i]+e;if(typeof t[r]=="string")return r}},a=u("transform"),f=u("transitionProperty"),l=e.event,c,h;c=l.special.debouncedresize={setup:function(){e(this).on("resize",c.handler)},teardown:function(){e(this).off("resize",c.handler)},handler:function(e,t){var n=this,r=arguments,i=function(){e.type="debouncedresize";l.dispatch.apply(n,r)};h&&clearTimeout(h);t?i():h=setTimeout(i,c.threshold)},threshold:150};var p={csstransforms:function(){return!!a},csstransforms3d:function(){var t=!!u("perspective");if(t){var n=" -o- -moz- -ms- -webkit- -khtml- ".split(" "),r="@media ("+n.join("transform-3d),(")+"modernizr)",i=e("<style>"+r+"{#modernizr{height:3px}}"+"</style>").appendTo("head"),s=e('<div id="modernizr" />').appendTo("html");t=s.height()===3;s.remove();i.remove()}return t},csstransitions:function(){return!!f}},d;if(i)for(d in p)i.hasOwnProperty(d)||i.addTest(d,p[d]);else{i=t.Modernizr={_version:"1.6ish: miniModernizr for Isotope"};var v=" ",m;for(d in p){m=p[d]();i[d]=m;v+=" "+(m?"":"no-")+d}e("html").addClass(v)}var g;i.csstransitions&&(g={WebkitTransitionProperty:"webkitTransitionEnd",MozTransitionProperty:"transitionend",OTransitionProperty:"oTransitionEnd otransitionend",transitionProperty:"transitionend"}[f]);e.Procession=function(t,n){this.options=t;this.element=e(n);this._create(t)};e.Procession.settings={orientation:"horizontal",transitionDuration:400,clickNav:!0,align:"none",origin:"auto",active:0,containerClass:"procession-container",containerStyles:{position:"relative",overflow:"hidden"},innerElement:"<div></div>",innerClass:"procession-inner",innerStyles:{position:"relative",display:"block"},sliderElement:"<div></div>",sliderClass:"procession-slider",sliderStyles:{position:"absolute"},itemClass:"procession-item",itemStyles:{position:"absolute","-webkit-backface-visibility":"hidden","-webkit-perspective":1e3}};e.Procession.prototype._create=function(t){this.options=e.extend(!0,{},e.Procession.settings,t);this.firstRun=!0;this._addTransitionStyles();this._build();this.appendPos=0;this.prependPos=0;this.appendIndex=this.options.active;this.prependIndex=this.appendIndex>0?this.appendIndex-1:this.$items.length-1;this.options.origin!=="center"&&(this.options.orientation==="horizontal"?this.$slider.css("left",this.options.origin):this.options.orientation==="vertical"&&this.$slider.css("top",this.options.origin));this._saveDimensions(this.$items);this.$items=this.$items.detach();this.$activeItem=this.$items.first();this._interactions();this._init()};e.Procession.prototype._init=function(){this.layout();this._activate(this._getItems(".origin"));var n=this;e(t).on("debouncedresize.procession",function(){n.layout(!1,!0)})};e.Procession.prototype._restoreStyles=function(e){e.css(e.data("originalStyles"))};e.Procession.prototype._saveStyles=function(e){var t=e.attr("data-procession-element")+"Styles",n={};for(var r in this.options[t])n[r]=e.css(r);e.data("originalStyles",n)};e.Procession.prototype.destroy=function(){this.$slider.remove();this._restoreStyles(this.$items);this.$items.removeClass(this.options.itemClass);this.$inner.empty().append(this.$items);this._restoreStyles(this.$inner);this.$inner.removeClass(this.options.innerClass);this.options.innerSelector||this.$inner.remove();this._restoreStyles(this.$container);this.$container.removeClass(this.options.containerClass);this.element.removeData("procession")};e.Procession.prototype._build=function(){this.$container=this.element;this.$container.addClass(this.options.containerClass);this.$container.attr("data-procession-element","container");this._saveStyles(this.$container);this.$container.css(this.options.containerStyles);this.$items=this._getItems();this.$items.addClass(this.options.itemClass);this.$items.attr("data-procession-element","item");this._saveStyles(this.$items);this.$items.css(this.options.itemStyles);this.$inner=this._getInner();if(this.$inner===r||!this.$inner.length){this.$inner=e(this.options.innerElement);this.$inner.appendTo(this.$container)}this.$inner.addClass(this.options.innerClass);this.$inner.attr("data-procession-element","inner");this._saveStyles(this.$inner);this.$inner.css(this.options.innerStyles);this.$slider=e(this.options.sliderElement);this.$slider.addClass(this.options.sliderClass);this.$slider.attr("data-procession-element","slider");this.$slider.css(this.options.sliderStyles);this.$slider.appendTo(this.$inner)};e.Procession.prototype.layout=function(e,t){this._geometry(e);this._appendItems();this._prependItems();if(this.firstRun){this.firstRun=!1;return}var n=this;this.$slider.one(g,function(){n._trimItems()});this.$slider.one("animationend",function(){n._trimItems()});t&&n._trimItems()};e.Procession.prototype._trimItems=function(){var t=this;this._getItems().each(function(){var n=e(this),r,i;if(t.options.orientation==="horizontal"){r=n.offset().left;i=n.data("outerWidth");if(r+i<t.geometry.container.left){t.prependPos+=i;t.prependIndex=t.prependIndex<t.$items.length-1?t.prependIndex+1:0;n.remove()}else if(r>t.geometry.container.left+t.geometry.container.width){t.appendPos-=i;t.appendIndex=t.appendIndex>0?t.appendIndex-1:t.$items.length-1;n.remove()}}else if(t.options.orientation==="vertical"){r=n.offset().top;i=n.data("outerHeight");if(r+i<t.geometry.container.top){t.prependPos+=i;t.prependIndex=t.prependIndex<t.$items.length-1?t.prependIndex+1:0;n.remove()}else if(r>t.geometry.container.top+t.geometry.container.height){t.appendPos-=i;t.appendIndex=t.appendIndex>0?t.appendIndex-1:t.$items.length-1;n.remove()}}})};e.Procession.prototype._interactions=function(){var t=this,r=[37,38,39,40],i=[];this.options.clickNav&&this.$slider.on("click","."+this.options.itemClass,function(){t._activate(e(this))});if(this.options.keyNav){e(n).keydown(function(n){if(e.inArray(n.which,r)===-1)return;if(!t.$container.is(":focus"))return;n.preventDefault();switch(n.which){case 38:if(!i[38]){t._activate(t.$activeItem.prev());i[38]=!0}break;case 39:if(!i[39]){t._activate(t.$activeItem.next());i[39]=!0}break;case 40:if(!i[40]){t._activate(t.$activeItem.next());i[40]=!0}break;case 37:if(!i[37]){t._activate(t.$activeItem.prev());i[37]=!0}}});e(n).keyup(function(e){var t=e.keyCode?e.keyCode:e.which;i[t]=!1})}};e.Procession.prototype._activate=function(e){var t,n;if(this.options.orientation==="horizontal"){t=this.$activeItem.position().left;n=e.position().left}else{t=this.$activeItem.position().top;n=e.position().top}var r=n-t;this.$activeItem.removeClass("active");e.addClass("active");this.$activeItem=e;if(r===0)return;this.layout(r);this._slideToItem(e)};e.Procession.prototype._slideToItem=function(e){var t;t=this.options.orientation==="horizontal"?e.position().left:e.position().top;this.options.origin==="center"&&(this.options.orientation=="horizontal"?t-=this.geometry.inner.width/2-e.data("outerWidth")/2:this.options.orientation=="vertical"&&(t-=this.geometry.inner.height/2-e.data("outerHeight")/2));this._slideTo(t)};e.Procession.prototype._slideTo=function(t){i.csstransforms3d?this.options.orientation==="horizontal"?this.$slider.css("transform","translate3d("+ -t+"px, 0, 0)"):this.$slider.css("transform","translate3d(0, "+ -t+"px, 0)"):i.csstransforms?this.options.orientation==="horizontal"?this.$slider.css("transform","translateX("+ -t+"px)"):this.$slider.css("transform","translateY("+ -t+"px)"):this.options.orientation==="horizontal"?this.$slider.animate({left:-t},this.options.transitionDuration,function(){e(this).trigger("animationend")}):this.$slider.animate({top:-t},this.options.transitionDuration,function(){e(this).trigger("animationend")})};e.Procession.prototype._geometry=function(e){this.geometry={container:{top:this.$container.offset().top,left:this.$container.offset().left,width:this.$container.outerWidth(),height:this.$container.outerHeight()},inner:{width:this.$inner.width(),height:this.$inner.height()},slider:{top:this.$slider.offset().top,left:this.$slider.offset().left}};this.geometry.container.right=this.geometry.container.left+this.geometry.container.width;this.geometry.container.bottom=this.geometry.container.top+this.geometry.container.height;this.geometry.slider.appendSpace=this.options.orientation==="horizontal"?this.geometry.container.right-this.geometry.slider.left:this.geometry.container.bottom-this.geometry.slider.top;this.geometry.slider.prependSpace=this.options.orientation==="horizontal"?this.geometry.container.left-this.geometry.slider.left:this.geometry.container.top-this.geometry.slider.top;if(typeof e!="undefined"){this.options.origin==="center"&&this.options.orientation!=="horizontal"&&this.options.orientation==="vertical";e>0?this.geometry.slider.appendSpace+=e:e<0&&(this.geometry.slider.prependSpace-=Math.abs(e))}if(this.firstRun&&this.options.origin==="center")if(this.options.orientation==="horizontal"){this.appendPos=this.geometry.inner.width/2-this.$items.first().data("outerWidth")/2;this.prependPos+=this.appendPos}else if(this.options.orientation==="vertical"){this.appendPos=this.geometry.inner.height/2-this.$items.first().data("outerHeight")/2;this.prependPos+=this.appendPos}};e.Procession.prototype._appendItems=function(){var t=[];while(this.appendPos<this.geometry.slider.appendSpace){var n=this.$items.eq(this.appendIndex).clone(!0);this.options.orientation==="horizontal"?n.css("left",this.appendPos):n.css("top",this.appendPos);this.options.align&&this._align(n,this.options.align);t.push(n);this.options.orientation==="horizontal"?this.appendPos+=n.data("outerWidth"):this.appendPos+=n.data("outerHeight");this.appendIndex=this.appendIndex<this.$items.length-1?this.appendIndex+1:0}this.firstRun&&t[0].addClass("origin");var t=e.map(t,function(e){return e.get()});this.$slider.append(t)};e.Procession.prototype._prependItems=function(){var t=[];while(this.prependPos>this.geometry.slider.prependSpace){var n=this.$items.eq(this.prependIndex).clone(!0);this.options.orientation==="horizontal"?this.prependPos-=n.data("outerWidth"):this.prependPos-=n.data("outerHeight");this.options.orientation==="horizontal"?n.css("left",this.prependPos):n.css("top",this.prependPos);this.options.align&&this._align(n,this.options.align);t.push(n);this.prependIndex=this.prependIndex>0?this.prependIndex-1:this.$items.length-1}t.reverse();t=e.map(t,function(e){return e.get()});this.$slider.prepend(t)};e.Procession.prototype._saveDimensions=function(t){var n=this;t.each(function(){var t=e(this).outerWidth(!0),n=e(this).outerHeight(!0);if(t<1||n<1){console.log("items must have dimensions");return}e(this).data({outerWidth:t,outerHeight:n})})};e.Procession.prototype._align=function(e,t){var n;if(this.options.orientation==="horizontal"){switch(t){case"center":n=this.geometry.inner.height/2-e.data("outerHeight")/2;break;case"bottom":n=this.geometry.inner.height-e.data("outerHeight");break;default:n=0}e.css("top",n)}else if(this.options.orientation==="vertical"){switch(t){case"center":n=this.geometry.inner.width/2-e.data("outerWidth")/2;break;case"right":n=this.geometry.inner.width-e.data("outerWidth");break;default:n=0}e.css("left",n)}};e.Procession.prototype._addTransitionStyles=function(){var t=this.options.transitionDuration/1e3+"s",n=this;e.each(o,function(){var e=this.toLowerCase();n.options.sliderStyles["-"+e+"-transition-duration"]=t;n.options.sliderStyles["-"+e+"-transition-property"]="-"+e+"-transform";n.options.sliderStyles["-"+e+"-transition-timing-function"]=n.options.easing});this.options.sliderStyles["transition-duration"]=t;this.options.sliderStyles["transition-property"]="transform";this.options.sliderStyles["transition-timing-function"]=n.options.easing};e.Procession.prototype._getItems=function(e){var t=this.options.itemSelector,n=t?this.element.find(t):this.element.children();return arguments.length?n.filter(e):n};e.Procession.prototype._getInner=function(){var e=this.options.innerSelector;return e?this.element.find(e):r};e.Procession.prototype._getSlider=function(){var e=this.options.sliderSelector;return e?this.element.find(e):r};e.Procession.prototype.option=function(t,n){e.isPlainObject(t)&&(this.options=e.extend(!0,this.options,t))};e.fn.procession=function(t){if(typeof t=="string"){var n=Array.prototype.slice.call(arguments,1);this.each(function(){var r=e.data(this,"procession");if(!r){console.log("error","cannot call methods on procession prior to initialization; attempted to call method '"+t+"'");return}if(!e.isFunction(r[t])||t.charAt(0)==="_"){console.log("error","no such method '"+t+"' for procession instance");return}r[t].apply(r,n)})}else this.each(function(){var n=e.data(this,"procession");if(n){n.option(t||{});n._init()}else e.data(this,"procession",new e.Procession(t,this))});return this}})(jQuery,window,document);